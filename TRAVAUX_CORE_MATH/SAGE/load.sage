load('e.sage')
load('table_alpha_mo.sage') # table des valeurs alpha_i et log(alpha_i)
load('table_alpha.sage')
load('table_alpha_triple.sage')
load('DEKKER_product.sage')
load('identical_bits.sage')

R200 = RealField(200)
R161 = RealField(161)
R107 = RealField(107)
R53u = RealField(53,rnd = 'RNDU')
R53d = RealField(53,rnd = 'RNDD')
R53z = RealField(53,rnd = 'RNDZ')

f7 = RR(0.141270897304995757259860056365141645073890686035156)
f6 = RR(-0.16665893238270268472689394911867566406726837158203)
f5 = RR(0.19999998214690262177128943221759982407093048095703)
f4 = RR(-0.24999999998080402185962611838476732373237609863281)
f3 = RR(0.33333333333332582082420003644074313342571258544922)
f2 = RR(-0.5)
f1 = RR(1.0)

f(x)=f7 * x^7 + f6 * x^6 + f5 * x^5 + f4 * x^4 +f3 * x^3 + f2 * x^2 + f1 * x


g11 = R107("8.9146484193927792863883461018515185767240227939568e-2")
g10 = R107("-9.9983795772704279626143673489119577619874187122614e-2")
g9 =  R107("0.111111026879012455652897916473747558708073909699583")
g8 =  R107("-0.12499999972842441681715216710341738452607696803868")
g7 =  R107("0.142857142856581726172999965645732624209713361495893") 
g6 =  R107("-0.166666666666665925131268248607538033671364284324883")  
g5 =  R107("0.199999999999999999393471182182787509887129262646114") 
g4 =  R107("-0.24999999999999999999971460545900410012449954313543") 
g3 =  R107("0.33333333333333333333333326668700729276451868587435") 
g2 =  R107("-0.49999999999999999999999999999458274425242758299252")  
g1 =  R107("1.0")
g(x) = g11 * x^11 + g10 * x^10 + g9 * x^9 + g8* x^8 + g7* x^7 + g6* x^6 + g5* x^5 + g4* x^4 + g3* x^3 + g2* x^2 + g1 * x

G = [('0x1.6d24dd22a92bp-4', '0x1.3e16deaf82f98p-58'),
 ('-0x1.99889bcf944ecp-4', '-0x1.14f5635667f7p-58'),        #Coefficient of g decomposed into double,double
 ('0x1.c71c5b2ab9b1bp-4', '-0x1.bba8402b8dab8p-58'),
 ('-0x1.ffffffed56645p-4', '0x1.fa475383e2fep-60'),
 ('0x1.249249248d599p-3', '0x1.a5c92da9d350cp-57'),
 ('-0x1.555555555553bp-3', '0x1.887e7d473e27p-57'),
 ('0x1.999999999999ap-3', '-0x1.affa1a4be0d04p-57'),
 ('-0x1p-2', '0x1.590555132p-72'),
 ('0x1.5555555555555p-2', '0x1.55555540b5114p-56'),
 ('-0x1p-1', '0x1.b78p-98'),
 ('0x1p+0', '0x0p+0')]


p12 = R107("-8.1556728417420567195873488043373823361123146018224e-2")
p11 = R107("9.0891001974044950501418042589588361350378534325486e-2") 
p10 = R107("-9.9999894055187305740569674081962316811984495513715e-2") 
p9 = R107("0.111111110717669834936638802798847681931573689823356")  
p8 = R107("-0.124999999999035895084705001113767563266917776158332") 
p7 = R107("0.14285714285714128410256991383268789904686423752787")  
p6 = R107("-0.166666666666666664982577174510632263492000013725566")  
p5 = R107("0.199999999999999999998863626814818869467604710400085") 
p4 = R107("-0.24999999999999999999999955279776652538538465875394")  
p3 = R107("0.33333333333333333333333333324495831437056586755988")
p2 = R107("-0.49999999999999999999999999999999383702417796084527") 
p1 = R107("1.0 ")

p(x) = p12 * x^12 + p11 * x^11 + p10 * x^10 + p9 * x^9 + p8 * x^8 + p7 * x^7 + p6 * x^6 + p5 * x^5 + p4 * x^4 + p3 * x^3 + p2 * x^2 + p1 * x

P =[('-0x1.4e0e6d95252cp-4', '-0x1.12811698d5b1p-59'),
 ('0x1.744a1f8faac7ep-4', '-0x1.40aff8485208p-58'),
 ('-0x1.99997d2920beap-4', '-0x1.b00b4cee548p-61'),
 ('0x1.c71c71ac12f3dp-4', '-0x1.3f62b4a898c3p-58'),
 ('-0x1.ffffffffef0a1p-4', '0x1.4a1f57fc92eep-60'),
 ('0x1.249249249245ap-3', '-0x1.8e5f2be8521e4p-57'),
 ('-0x1.5555555555555p-3', '-0x1.17338ecb4b208p-57'),
 ('0x1.999999999999ap-3', '-0x1.99a4552e88628p-57'),
 ('-0x1p-2', '0x1.14ce05cp-81'),
 ('0x1.5555555555555p-2', '0x1.555555554e54ep-56'),
 ('-0x1p-1', '0x1p-107'),
 ('0x1p+0', '0x0p+0')]

q13 = R107("7.5167989410714577210059835666722911796626006061341e-2")
q12 = R107("-8.3314161098380009457626618312437341916118256907136e-2")
q11 = R107("9.0908969261168212996219451139765494940229154199337e-2") 
q10 = R107("-9.9999999504784243939766969056655118895089160172418e-2") 
q9 = R107("0.11111111110976118785639295698765619630199425126676")  
q8 = R107("-0.124999999999997503566831049680756048669496808011576") 
q7 = R107("0.142857142857142854038581839300291006819165957902137")  
q6 = R107("-0.166666666666666666664152058379851763473019891193534")  
q5 = R107("0.199999999999999999999998755449231956379050286299637") 
q4 = R107("-0.249999999999999999999999999668413411846827358073694")  
q3 = R107("0.33333333333333333333333333333329840980367511145653")
q2 = R107("-0.5") 
q1 = R107("1.0 ")

q(x) = q13 * x^13 + q12 * x^12 + q11 * x^11 + q10 * x^10 + q9 * x^9 + q8 * x^8 + q7 * x^7 + q6 * x^6 + q5 * x^5 + q4 * x^4 + q3 * x^3 + q2 * x^2 + q1 * x

Q = [('0x1.33e3598399fb9p-4', '-0x1.b9877338e92cp-61'),
 ('-0x1.4e0e6d95252cp-4', '-0x1.12811698d5b1p-59'),
 ('0x1.745cf69e3c911p-4', '-0x1.7f3b380f2d4cp-58'),
 ('-0x1.9999997791ac2p-4', '0x1.3ed8c786dfba8p-58'),
 ('0x1.c71c71c704b24p-4', '0x1.c7d4ab9dfbe6p-59'),
 ('-0x1.fffffffffff4cp-4', '-0x1.cefad1d142fep-60'),
 ('0x1.2492492492492p-3', '0x1.64167805e7b18p-58'),
 ('-0x1.5555555555555p-3', '-0x1.553d956231518p-57'),
 ('0x1.999999999999ap-3', '-0x1.99999c9bf08a8p-57'),
 ('-0x1p-2', '0x1.a456p-92'),
 ('0x1.5555555555555p-2', '0x1.555555555554ap-56'),
 ('-0x1p-1', '0x0p+0'),
 ('0x1p+0', '0x0p+0')]

s14 = R107("-7.1678246804749844355198419342713199760408426365967e-2")
s13 = R107("7.695369330612240669974186483388518541399510068107e-2")
s12 = R107("-8.3333771179438077947364049425307501603173155685615e-2")
s11 = R107("9.0909094094459755107041910518580114974701355440263e-2") 
s10 = R107("-0.10000000001428577713001143619639306525156352871272") 
s9 = R107("0.111111111111153398258503961271773628571928173843289")  
s8 = R107("-0.12500000000000008461272107929314912095291975332232") 
s7 = R107("0.14285714285714285725700605753981174258712858300505")  
s6 = R107("-0.16666666666666666666676777200787272977413630663346")  
s5 = R107("0.200000000000000000000000055446533324991500721232") 
s4 = R107("-0.25000000000000000000000000001670782745354814847243")  
s3 = R107("0.33333333333333333333333333333333538765860734638491")
s2 = R107("-0.5") 
s1 = R107("1.0 ")

sa(x) = s14 * x^14 + s13 * x^13 + s12 * x^12 + s11 * x^11 + s10 * x^10 + s9 * x^9 + s8 * x^8 + s7 * x^7 + s6 * x^6 + s5 * x^5 + s4 * x^4 + s3 * x^3 + s2 * x^2 + s1 * x

S = [('-0x1.259816ddc6b9ep-4', '0x1.f229b0ebc95e8p-58'),
 ('0x1.3b33cbc0e63c5p-4', '-0x1.31408a44f4e3p-59'),
 ('-0x1.5555cadde3778p-4', '-0x1.bda92435f3d6p-60'),
 ('0x1.745d1820b70e5p-4', '-0x1.dbf2039485fp-63'),
 ('-0x1.9999999a94ebp-4', '-0x1.50d87266ccc78p-58'),
 ('0x1.c71c71c71d304p-4', '-0x1.c82589f54b808p-58'),
 ('-0x1.0000000000003p-3', '-0x1.8d4472e3c5b8p-60'),
 ('0x1.2492492492492p-3', '0x1.28c8644888e58p-57'),
 ('-0x1.5555555555555p-3', '-0x1.555649ca82244p-57'),
 ('0x1.999999999999ap-3', '-0x1.9999997747bfp-57'),
 ('-0x1p-2', '-0x1.52ep-96'),
 ('0x1.5555555555555p-2', '0x1.5555555555556p-56'),
 ('-0x1p-1', '0x0p+0'),
 ('0x1p+0', '0x0p+0')]


t11 = R161("8.9138795759159625000419345851649728648003006418317e-2") 
t10 = R161("-9.99836381190361256071937274804735427860788111386e-2")
t9 = R161("0.111111025493600522073703933726678184158165994756013") 
t8 = R161("-0.124999999721610982042116601405384526543576104437807")
t7 = R161("0.14285714285656118339564809417100715034533359159897")
t6 = R161("-0.16666666666666588602628059288197267979849863906595")
t5 = R161("0.19999999999999999934682134388889319100621200580212")
t4 = R161("-0.249999999999999999999681162605655507510389557007983")
t3 = R161("0.33333333333333333333333325351550981815323507815188")
t2 = R161("-0.49999999999999999999999999999220679620680786932661")
t1 = R161("0.99999999999999999999999999999999987422480092397931")

t(x) = t11 * x^11 + t10 * x^10 + t9 * x^9 + t8 * x^8 + t7 * x^7 + t6 * x^6 + t5 * x^5 + t4 * x^4 + t3 * x^3 + t2 * x^2 + t1 * x

T = [('0x1.6d1ccd4972561p-4', '-0x1.adef02059f58cp-58', '-0x1.f5e334821e538p-112'),
 ('-0x1.9988717db3a5ap-4', '0x1.4bda828a49c92p-59', '0x1.6e8ebefa3caep-114'),
 ('0x1.c71c5acb8545p-4', '-0x1.e501352a638fcp-60', '-0x1.5765da81cb9cp-114'),
 ('-0x1.ffffffecde875p-4', '-0x1.466590bd6cdb6p-59', '0x1.298740e7c45p-116'),
 ('0x1.249249248d2b5p-3', '0x1.1f12b71e8755fp-57', '-0x1.b7c7452f9130cp-111'),
 ('-0x1.5555555555539p-3', '-0x1.a992b06ebb311p-58', '-0x1.7dbe616232b4p-112'),
 ('0x1.999999999999ap-3', '-0x1.b1b2b2af340ap-57', '-0x1.2cc5f36fb46d8p-112'),
 ('-0x1p-2', '0x1.817364e50e56ap-72', '-0x1.0c356c2fp-129'),
 ('0x1.5555555555555p-2', '0x1.5555553ca1839p-56', '-0x1.3d6a7908ccd0cp-110'),
 ('-0x1p-1', '0x1.3c2141514a102p-97', '-0x1.ecp-151'),
 ('0x1p+0', '-0x1.4e5e2a35c711p-113', '0x0p+0')]


u14 = R161("-6.9631309428403421091239071145175881397990358673378e-2")
u13 = R161("7.6901241497417274809454044509085498344068530926476e-2")
u12 = R161("-8.3333176762879409621260290978612206069346870797373e-2")
u11 = R161("9.0909090174300552066151412403298151594936885182447e-2")
u10 = R161("-9.999999999763114503462553450435630641978064720853e-2")
u9 = R161("0.111111111111105751994472172183605657762943752235207")
u8 = R161("-0.124999999999999991459797911078615724445648770928098")
u7 = R161("0.14285714285714285713337405348046501659022471438614")
u6 = R161("-0.16666666666666666666665952018111437413873148473579")
u5 = R161("0.199999999999999999999999996511388379224966187941427")
u4 = R161("-0.249999999999999999999999999998979981104015141154306")
u3 = R161("0.33333333333333333333333333333333317771802607031295")
u2 = R161("-0.4999999999999999999999999999999999999906494914173")
u1 = R161("0.99999999999999999999999999999999999999999990683384")

u(x) = u14 * x^14 + u13 * x^13 + u12 * x^12 + u11 * x^11 + u10 * x^10 + u9 * x^9 + u8 * x^8 + u7 * x^7 + u6 * x^6 + u5 * x^5 + u4 * x^4 + u3 * x^3 + u2 * x^2 + u1 * x

U = [('-0x1.1d35b84c5cc56p-4', '0x1.780337dcf5705p-58', '-0x1.b91450d691e2p-114'),
 ('0x1.3afccbd40d20fp-4', '0x1.9c4dd4dab116p-58', '0x1.3a1e112af7efp-112'),
 ('-0x1.55552b4de4c76p-4', '-0x1.50aa78415c4bfp-59', '0x1.2fafbf95a1a8p-115'),
 ('0x1.745d171352e2dp-4', '-0x1.b9a4b0517c2c6p-58', '-0x1.6128b0932efc8p-112'),
 ('-0x1.999999996fed4p-4', '0x1.8ec6a7a38be73p-58', '-0x1.85507f01f5868p-112'),
 ('0x1.c71c71c71c59ap-4', '0x1.1e1945381ebebp-58', '-0x1.b30f3065fce38p-112'),
 ('-0x1.fffffffffffffp-4', '-0x1.89d824c2891b7p-58', '0x1.b4f656bbfa58p-115'),
 ('0x1.2492492492492p-3', '0x1.2438b8708dbd8p-57', '0x1.e00436fa1c45p-113'),
 ('-0x1.5555555555555p-3', '-0x1.5555440ddf7efp-57', '0x1.0fce30dd1d9p-116'),
 ('0x1.999999999999ap-3', '-0x1.9999999bc2648p-57', '0x1.4e3f5d1a3a7p-117'),
 ('-0x1p-2', '0x1.4b03dac3ad4d9p-100', '0x1.78p-156'),
 ('0x1.5555555555555p-2', '0x1.5555555555555p-56', '0x1.219f0c0c44756p-110'),
 ('-0x1p-1', '0x1.9745a799cp-127', '0x0p+0'),
 ('0x1p+0', '-0x1.09f14p-143', '0x0p+0')]
 